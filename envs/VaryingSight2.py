import envs.BasicEnv as Env
import random
import matplotlib.pyplot as plt


# Params
INTERACTION_ROUND = 1000

AGENT_NUM = 100
BANDWIDTH = 4
NEIGHBORHOOD_SIZE = 12

REWIRING_COST = 40
REWIRING_PROBABILITY = 0.01

K = 4

REWIRING_STRATEGY = 0

NETWORK_TYPE = 0
DISTRIBUTION_TYPE = 0

EPISODE = 20

average_reward = []
highest_reward = []
lowest_reward = []
average_rewiring = 0.0

DEBUG = -1

c_sight_pair = []
for x in range(0,41):
    c_sight_pair.append(x * 0.1)
print(c_sight_pair)


sg_result = []

if __name__ == '__main__':

    for sg in [0,1,2,3,4]:
        result = []
        REWIRING_STRATEGY = sg

        if REWIRING_STRATEGY == 0:
            print('--Rewiring strategy: Random')
        if REWIRING_STRATEGY == 1:
            print('--Rewiring strategy: HE')
        if REWIRING_STRATEGY == 2:
            print('--Rewiring strategy: Opt1')
        if REWIRING_STRATEGY == 3:
            print('--Rewiring strategy: Opt2')
        if REWIRING_STRATEGY == 4:
            print('--Rewiring strategy: Opt3')

        print('Rewiring cost:', REWIRING_COST)
        for sight in c_sight_pair:
            y_axi = []

            average_reward = []
            highest_reward = []
            lowest_reward = []
            average_rewiring = 0.0
            print('Sight:' + str(sight))
            K = sight

            for repeat in range(EPISODE):
                if DEBUG > -1:
                    print('Episode: ' + str(repeat))

                # init Env
                env = Env.BasicEnv(AGENT_NUM,
                                   NETWORK_TYPE,
                                   BANDWIDTH,
                                   NEIGHBORHOOD_SIZE,
                                   REWIRING_COST,
                                   REWIRING_PROBABILITY,
                                   DISTRIBUTION_TYPE,
                                   REWIRING_STRATEGY,
                                   K)

                phi = env.phi

                for iteration in range(INTERACTION_ROUND):
                    if DEBUG > 0:
                        print('-- Interaction round: ', iteration)
                    # to avoid the the problem that decision order may influence the fairness
                    # shuffle the order at every iteration
                    agents = env.network.nodes()
                    # random.shuffle(agents)
                    # print('Env initialized.')

                    # rewiring phase
                    # print('Rewiring phase.')

                    # do rewiring
                    # should be good with sparse rewiring
                    for i in agents:
                        agent = env.network.node[i]
                        if random.uniform(0, 1) < phi:
                            neighbors_num = len(env.getNeighbors(i))
                            # print(network.neighbors(i))
                            if neighbors_num > 0:
                                if len(agent['S_'] + agent['BL']) > 0:
                                    # do rewire
                                    if DEBUG > 0:
                                        print('Agent ' + str(i) + ' does rewiring.')
                                    env._rewire(i)
                                else:
                                    if DEBUG > 0:
                                        print('No more available potential peers.')
                            else:
                                if DEBUG > 0:
                                    print('Agent ' + str(i) + ' is isolated.')
                                # TO-DO
                                if len(agent['S_'] + agent['BL']) > 0:
                                    # do rewire
                                    if DEBUG > 0:
                                        print('Agent ' + str(i) + ' does rewiring.')
                                    env._rewire(i)
                                else:
                                    if DEBUG > 0:
                                        print(i, 'has no more available potential peers.')

                    # TO-DO
                    # more reasonable situation, but complex
                    # 1) raise rewiring proposals.
                    # 2) decide rewiring target

                    # interaction phase
                    # print('Interaction phase.')
                    for i in env.network.nodes():
                        # do interaction
                        neighborhood = env.getNeighbors(i)
                        if len(neighborhood) > 0:
                            # 1) randomly choose a opponent in S (choose the best opponent)
                            oppo_index = random.randint(0, len(neighborhood) - 1)
                            oppo_agent_no = neighborhood[oppo_index]

                            # sort the players
                            left = min(i, oppo_agent_no)
                            right = max(i, oppo_agent_no)

                            # 2) agent i interacts with certain opponent
                            env._interact(left, right)
                            # env._interact(i, oppo_agent_no)
                        else:
                            if DEBUG > 0:
                                print('agent ', i, ' has no neighbor.')

                                # statistic
                group_reward, group_rewiring = env.printAgentInfo(0)
                average_reward.append(sum(group_reward) / AGENT_NUM)
                highest_reward.append(max(group_reward))
                lowest_reward.append(min(group_reward))

                average_rewiring = average_rewiring + group_rewiring / AGENT_NUM

                # print(env.oppActionDis)

            # print('--------------------------------------------------------------------')
            # print('--------------------------------------------------------------------')
            # print('Final outputs:')
            # print('Mean average rewiring: ' + str(average_rewiring / EPISODE))
            print('Mean average reward: ' + str(sum(average_reward) / EPISODE))
            # print('Mean highest reward: ' + str(sum(highest_reward) / EPISODE))
            # print('Mean lowest reward: ' + str(sum(lowest_reward) / EPISODE))
            # print('--------------------------------------------------------------------')
            # print('--------------------------------------------------------------------')

            result.append(sum(average_reward) / EPISODE)
        print('Interim result:', result)
        sg_result.append(result)

    print('======================================')
    print('Results below.')

    for l in sg_result:
        print(l)

    # plt.xlim(0.0, 1.0)
    # plt.ylim(-0.1, 1.0)

    # for y in y_list:
    #     plt.plot(x_axi, y)
    # plt.title('(50,3,9) - Optimal - k-sight')
    #
    # plt.show()




############################################################
# Results

# 18/01/24
# Pure Env
# fix rewiring cost c as a specific problem
# varing sight to find optimal strategy

# EPISODE = 10
# [20, x * 0.1]
# [907.76887469659835, 887.42837325437267, 899.49697529120965, 893.81838923275313, 905.56645481180351, 914.01811081706796, 895.53326655718206, 899.72374060347465, 901.34607991506891, 906.9829255512484, 893.75023302970385, 913.65886338866017, 919.72446320790789, 896.36453259195855, 900.96722787140482, 905.76714931078641, 903.85728126803349, 898.77032861912119, 894.28515990703238, 916.20222703392687, 891.19120497889344]
# [1137.6604706578494, 1143.3495418875605, 1138.5834978176633, 1156.1785529830424, 1145.9777018059783, 1194.2741056333632, 1287.1930213457872, 1272.4486066682043, 1193.4955423208355, 1119.7932632019008, 1084.7787386369705, 1071.5901011992337, 1062.4906656232638, 1059.3256079401692, 1052.254776765132, 1060.3458931486161, 1051.6660491886391, 1047.5814696184459, 1052.2510248426668, 1057.6419193257375, 1056.2528034073662]
# [1131.9105022410311, 1140.072564531655, 1144.3450071520274, 1157.3626287981585, 1160.7462350829603, 1144.3321060442408, 1142.8928525092576, 1132.838428538364, 1151.9389771972099, 1147.2946941602261, 1165.5080127246424, 1169.3200369518668, 1159.8165137706292, 1184.3877000305977, 1182.9730211405208, 1183.1751980541339, 1199.0598942984107, 1215.6341344020345, 1218.9227248044788, 1231.2916773936636, 1215.3398222569342]
# [1156.4368579875845, 1142.6868253575005, 1142.2180728460796, 1144.074714772129, 1130.9214704171138, 1186.4920143338875, 1232.7969859737618, 1265.2070337258019, 1264.481245724942, 1252.6673735111942, 1277.6606241332988, 1270.4350401754546, 1269.6541425913515, 1274.7912539926547, 1273.3677190896913, 1262.0115113797965, 1290.118348029529, 1264.5061042203288, 1281.250722678579, 1284.7483692984463, 1274.4794622445329]
# [1149.0101739781226, 1147.0767526685418, 1131.8801911978769, 1143.889826671, 1145.1474847388895, 1142.0433132293902, 1180.7631021057764, 1249.3517343693936, 1294.784158041012, 1308.0928690361447, 1321.1824925685571, 1330.4255038412934, 1330.0597718608287, 1323.9115680503769, 1328.2491522548619, 1324.5923369845568, 1330.2027522948247, 1319.590385602462, 1345.8819288321542, 1339.6633011683364, 1338.5238514222299]


# [40, x * 0.2]
# [899.63087054513221, 908.42822342571731, 896.43803701944285, 901.9635430948025, 909.79737440465669, 903.81208857203421, 890.78505250157343, 912.52649954532967, 905.06094919159682, 903.3152456381913, 896.56995751240936, 913.86289541270196, 906.55211461650765, 901.22343301364526, 895.72719457542621, 901.99103992816924, 902.71246820621161, 899.23412730497182, 899.21993725889877, 896.93009653422757, 905.16252828609686]
# [1135.2337219303479, 1152.53752891462, 1159.9597596320407, 1305.0910918705915, 1189.2780808102684, 1073.2811498535852, 1057.5860376337334, 1050.2717597652224, 1055.1901799510167, 1046.0042964190429, 1050.9868931265125, 1039.7413145356063, 1055.89838436184, 1049.654646360043, 1056.3721471880722, 1058.9513535052899, 1054.1743565397178, 1063.0166692486089, 1052.1669076550586, 1063.4067963984721, 1049.9991988179704]
# [1127.448864666994, 1159.4332871136828, 1153.6475451219912, 1132.8902695557017, 1137.1296414125804, 1175.394147354898, 1157.603334676762, 1180.9862571374267, 1215.7200921606932, 1188.1621648550522, 1239.0537689818168, 1229.5613623385543, 1239.8699690765752, 1243.9467885969007, 1258.4502101434, 1253.9912777514724, 1255.7407739328412, 1236.5073845770976, 1266.4688341481724, 1265.3018291158769, 1262.8516368786206]
# [1149.5316656656269, 1147.9634018556312, 1139.545418114581, 1214.9801719826246, 1266.9663795481561, 1267.5297958989354, 1272.6925852166594, 1271.029144085481, 1266.7244065096265, 1281.6596045550839, 1275.7312077333504, 1279.0911934383723, 1278.949059358139, 1272.9437213842596, 1277.9295656139216, 1280.0496472659952, 1275.1747830938434, 1265.5846706073296, 1259.8687146810166, 1281.6878918767013, 1275.6623621294154]
# [1143.4793032459079, 1129.8333710786969, 1140.6277841685442, 1188.3095775759937, 1295.7256485845305, 1322.1619907420888, 1322.0865876918381, 1327.7429972859834, 1332.2599136635422, 1324.6006513775055, 1320.1395503095512, 1326.8551666155213, 1323.5283858306707, 1331.4619343712282, 1316.5673275488405, 1321.9663167696588, 1328.4345600844385, 1326.4965961473001, 1324.1929548448854, 1333.1282876514729, 1344.6790822966577]

# [60, x * 0.3]
# [901.47199233273602, 908.60970351058563, 900.89857380072931, 909.9884595721569, 904.02668011494097, 898.13891627321664, 891.38909148412063, 889.76761693829883, 909.19989558537782, 895.39122049351374, 905.34019754583426, 899.22438653355925, 908.79471549050027, 897.47763658570273, 906.04502876960873, 917.71698881541852, 907.83830994579762, 890.36211807586551, 895.14712331910573, 886.57099745962535, 892.47220885628963]
# [1150.9169206223346, 1154.3351515733459, 1305.4983444892946, 1131.7592749802016, 1068.0152731183437, 1047.4171259701834, 1057.7403344635998, 1049.700816411666, 1058.5990538919821, 1064.7805318789108, 1063.7931188799207, 1064.1723608188152, 1053.6945310064616, 1063.1926646454565, 1072.9101857962992, 1045.8099834441225, 1061.2992067110142, 1057.7726049642999, 1044.7619509194844, 1053.0474485047612, 1047.0811671967801]
# [1150.878118285927, 1141.6587955943837, 1128.2097802144458, 1162.6813513859274, 1188.9877256262857, 1189.6399662084002, 1223.165302124499, 1228.9655798283688, 1256.199217833265, 1252.0619649617031, 1256.5357231414614, 1265.3009748618708, 1268.7790782002344, 1258.9230502156236, 1267.558144686165, 1245.2894369506516, 1254.2143921679078, 1294.5305675866148, 1266.1854348885968, 1279.5500166559298, 1279.8055690608026]
# [1139.7306452526434, 1140.7496314402927, 1233.5320565059124, 1272.635673669344, 1273.7997330283144, 1273.4631740613902, 1273.2815881287477, 1280.3232864711665, 1275.2369692785367, 1267.161081237324, 1282.8469842269037, 1283.0693598071291, 1270.9703362707121, 1264.4864903520138, 1275.0844512262531, 1279.3773742511437, 1284.789411325673, 1273.5879834794007, 1269.5683197013479, 1284.1662738041148, 1270.0102665290049]
# [1149.4015543201872, 1155.3871163516965, 1186.284787975917, 1315.3887552105666, 1315.5573505252223, 1341.8351338949171, 1322.0069179613704, 1320.6206577211185, 1317.9224886380919, 1316.2158983098766, 1332.7302596511242, 1338.9709752350777, 1324.508421164807, 1320.233850151845, 1336.3441453545156, 1338.1944077373098, 1316.0955233245973, 1326.9109184538975, 1322.8773577571083, 1325.4358044317612, 1325.5004081385785]

# EPISODE
# C = 20,
# [995.29527130254792, 1002.5851849721312, 1003.251421161554, 1007.5659159875271, 997.17984542171291, 1006.8731495929424, 1003.417221019108, 993.42727052469309, 1005.0251057623767, 1025.3969466309059, 1013.4272229245831, 1005.9383427766619, 1000.0669608137894, 995.39351854184565, 1007.841640137857, 1003.3902362497098, 1002.8707013756921, 1001.4831520864211, 994.94369056190021, 1007.265666979177]
# [1264.177402939566, 1261.4306773039702, 1259.0641698211487, 1262.2214771463002, 1262.4667579051597, 1253.9186816440042, 1259.1001017265091, 1266.1873350912765, 1287.8939599555556, 1335.2520157854685, 1352.4120320446632, 1367.7086958351069, 1341.3496082494435, 1298.1695960760417, 1258.2583477944308, 1209.5375933451403, 1168.7208981943252, 1154.193292613317, 1139.9967923744166, 1130.6339358885757]
# [1265.4290129958313, 1257.6269816772951, 1239.3331172067635, 1230.0076949112376, 1209.5856021191851, 1187.1190682099223, 1156.281439151147, 1159.2626673157206, 1150.7375957611266, 1154.9445315486778, 1154.7649195826905, 1145.6014414265769, 1158.4129308175957, 1159.9765921692958, 1154.7813916010248, 1119.9522499396226, 1164.7382911347026, 1139.6791074059684, 1161.2073928548486, 1139.1612835824058]
# [1280.0840789322283, 1288.9334330163749, 1295.1866467209559, 1294.7558029216048, 1284.179786112581, 1289.4323676383633, 1297.3736233988243, 1291.4757958452392, 1278.1169164056553, 1276.6657637598605, 1266.415377533192, 1261.3873690403284, 1251.495742402604, 1221.59304192834, 1191.6019004839527, 1171.0984080135599, 1169.2942954451005, 1138.2721630263529, 1139.4044316469508, 1148.8796368844437]
# [1374.4803315372349, 1381.9234740810723, 1362.0975655357011, 1375.2295454231414, 1369.9284805846294, 1382.8462040387808, 1375.7037405980454, 1357.7930703162735, 1354.4675376707696, 1328.0807983564237, 1289.138721518319, 1241.5274608358502, 1188.4725500240527, 1161.0027169604195, 1157.2668070860504, 1138.2452658844272, 1128.136863236939, 1137.8281420866265, 1146.2473250032003, 1131.2869390405417]

# Wrong results
# c = 40, [0.4 - 4.4]
# [895.84988647270745, 907.72990035218902, 895.36942948220826, 897.70053141268932, 888.08008077304021, 903.47446568044302, 892.51318990586458, 894.30422848181365, 901.49620658652657, 899.13693739542668, 903.34258933979731, 877.63410148824698, 904.20196541394341, 898.50872128525918, 908.84563901727574, 913.71275483869317, 911.08063495705187, 903.49705996885007, 914.29404213967587, 906.30224376083424, 909.00950699846965]
# [1092.5384224505065, 1316.0872035986936, 1188.3013254245827, 1142.0003436590957, 1147.0088447554808, 1147.7057038462506, 1145.8498403237788, 1142.4616705341616, 1137.2448468264922, 1137.213986583741, 1140.4913006172405, 1139.7801030847363, 1149.9495928251463, 1142.8040286445716, 1151.6045577339776, 1150.0916772450869, 1141.4101498829793, 1134.9851693049152, 1144.4636580486369, 1140.4788862863293, 1143.6151367892544]
# [1170.0804240204811, 1149.0907383803915, 1151.2527020601224, 1159.1153366323845, 1149.3673095722115, 1136.8511854548924, 1136.9667410620525, 1136.8487352931525, 1139.3782488164541, 1147.6955865557807, 1124.9801257496838, 1129.1233959228935, 1137.5543119829092, 1126.8367911341998, 1132.0007221880628, 1168.6798449070416, 1151.1731356118007, 1164.402566475967, 1144.6034877602676, 1151.0263590009351, 1164.7885640686582]
# [1279.6877264438926, 1250.2442306893693, 1170.3999822661867, 1153.3718872665258, 1139.1893491072074, 1135.4910799718068, 1137.6059176871281, 1165.2509131562085, 1148.5314838893366, 1149.0711734450451, 1147.0361621882325, 1152.6964455205057, 1153.8669077903719, 1123.7407710741766, 1145.4536372006596, 1135.7777009617887, 1157.2523073589045, 1152.5735313882781, 1145.4178529249461, 1165.8417735871944, 1154.8262346841361]
# [1315.6396362796177, 1230.357614592755, 1142.7300484331413, 1149.5368763363526, 1146.9843904694105, 1136.9949231779206, 1154.4158621114343, 1159.619070291048, 1139.253394538438, 1136.5613701121756, 1137.1873534640829, 1139.8394807348868, 1134.7738339574171, 1153.9852387265587, 1156.3190906180575, 1136.5480958433964, 1129.981393984224, 1148.2331483431374, 1136.8394192884703, 1157.4549538468341, 1147.1107717219438]


# c = 20, [0.2 - 2.2]
# [1010.714431352308, 999.09832010297794, 994.76239263556783, 1009.0366472222235, 992.92640863531199, 1013.6110495618271, 1002.3033212760431, 997.14974502369512, 995.07477080552121, 1006.7934907400834, 1009.001892263924, 1001.3701682652132, 1002.7021203523971, 1008.6925609225815, 998.59680171574996, 1001.4831634811375, 1003.7665224067907, 995.52234708616231, 1001.9656819308082, 998.3325634174804, 991.11785421946092]
# [1262.9032871595909, 1255.8491211139021, 1271.3845953259472, 1302.6961444400608, 1366.677382703677, 1280.8783510039423, 1205.4134926253651, 1141.4362935311881, 1142.8363676233546, 1150.2164371518998, 1133.2765989373324, 1152.514410479436, 1142.5243644047787, 1132.1258621976299, 1147.2827631436483, 1142.4978272247304, 1147.0883348291206, 1146.0816842680174, 1140.8560142023982, 1136.4890581116156, 1136.8591173077198]
# [1211.0522782172004, 1186.8172505508041, 1156.1812931813088, 1150.4283436445007, 1138.2130452776405, 1138.4074285031938, 1142.4981698513732, 1156.4206682957322, 1143.4087180714912, 1132.7260046380275, 1159.1829485664357, 1133.8264412240701, 1145.0233198645167, 1150.5320573886511, 1147.4021470846319, 1143.3602839541797, 1134.3093744966523, 1147.1839192026507, 1126.8947003810201, 1156.5091486969507, 1162.2942201340977]
# [1294.1276079844752, 1294.5157925574001, 1288.346707996114, 1276.1603124034141, 1277.2846586723676, 1219.3721001189836, 1166.4025124317063, 1156.9601403420729, 1144.2353021139002, 1144.4217731589074, 1155.9494150371017, 1144.957033151532, 1153.2247928133324, 1134.9525169176468, 1143.4227681490534, 1142.6825776583705, 1141.5053387699481, 1150.019021820226, 1149.26354038412, 1152.938956359267, 1143.5893027294173]
# [1365.4157931510986, 1367.0578769582421, 1362.9621869510424, 1327.3592999041841, 1241.0301082672349, 1183.4658991398337, 1143.8605947732894, 1134.1123663293581, 1154.0361794042369, 1134.2822599191859, 1132.1966013980391, 1145.1409209403298, 1156.172944219468, 1141.0570212476189, 1147.4344318053209, 1135.2615539846654, 1153.0199911655275, 1138.5553696575278, 1120.9035386318642, 1150.8868510722552, 1152.3930736058687]

# c = 80, [0.8 - 8.8]
# [717.74949502610684, 701.67365396250477, 712.06977902656286, 699.55710497108907, 704.46414215112952, 709.44339581389363, 703.34376629126473, 712.02440970692669, 713.9210488357661, 702.00339801039513, 686.86598313937054, 696.01560318930001, 694.54033566914916, 704.75839596159972, 701.64611626836438, 670.62578111343544, 696.20587419605886, 683.98087461277123, 715.50189644722388, 704.62193712370811, 708.58947026643511]
# [1201.6914424229965, 1153.7704285578025, 1127.1348326906348, 1144.9189666417708, 1140.3651373461812, 1126.2560754479507, 1150.2149070577875, 1146.8312246066157, 1144.9231230495409, 1157.0407328828646, 1157.6648461080424, 1138.6789586764526, 1151.3547280103717, 1125.7589363183738, 1146.3325646450728, 1125.5880853865967, 1148.5889310020477, 1145.2820999043474, 1135.4048843063797, 1158.1962578036869, 1148.2205041079453]
# [1149.715711342699, 1156.6958344979821, 1146.2838146154356, 1138.6288197397475, 1155.8638728820445, 1134.7468612400528, 1157.9051041647267, 1156.2530699998201, 1133.893409043103, 1145.9024450241236, 1145.397551278822, 1146.1777145765968, 1144.8752415053618, 1146.0856193049333, 1138.7685853253672, 1150.4104204588955, 1138.570625562568, 1139.3880939489793, 1152.5667512274006, 1147.6086226228231, 1164.0339634886664]
# [1167.1149217363893, 1137.4604715041212, 1135.9681045867376, 1146.9823332886183, 1149.138726437254, 1145.0917266459974, 1149.2451028012329, 1149.6560283299368, 1142.271713196689, 1142.480876616487, 1150.9991184503526, 1151.8843719012043, 1142.4013282250382, 1158.7272727346249, 1128.0190734162104, 1132.3712124432136, 1127.8701192393125, 1155.0360263344742, 1147.1769368650573, 1134.238420843142, 1140.5916254924118]
# [1139.1007955491457, 1154.0493194068272, 1142.1251334688602, 1138.0227538138922, 1128.1830653953987, 1119.078413261868, 1156.381971248122, 1159.7101019646523, 1134.5089625242883, 1132.4500450673354, 1142.8734667599158, 1133.9974356002886, 1142.4607813531254, 1154.1646729600059, 1139.1209240073265, 1137.2582522982509, 1146.0664530563386, 1140.6310373056365, 1141.265401154458, 1151.7684520325756, 1128.6454632489565]

# correct
# c = 20, [0. - 2]
# [1003.8651690977798, 1008.5626099130668, 1008.1852569902294, 1009.5954727010607, 993.53321008840101, 1013.3231969510131, 994.17987273628785, 1001.742263898873, 995.21468221615999, 1003.2278135432203, 998.52036628912379, 1013.1662438267365, 1003.0864267268951, 996.72290348925458, 991.01023502409896, 1016.0021045452617, 986.26184795958034, 1005.9918494745567, 1011.7360471240602, 982.74176466914537, 999.8371849459769]
# [1143.0309446457579, 1153.6878196398293, 1149.7170952836518, 1298.2115540917089, 1331.9299318301305, 1268.2010458253278, 1254.8377806020394, 1251.7457184682012, 1258.1134603864332, 1249.4341891435065, 1249.1637268258505, 1244.8197147256465, 1252.4899023285275, 1257.1522998857763, 1257.9700698371619, 1248.3592924889012, 1252.0068158214042, 1249.2588290443659, 1257.903639626008, 1262.5158976752177, 1243.2949229892099]
# [1146.1282463133343, 1141.4749267040468, 1151.8794591376081, 1143.7349532747219, 1146.7920488013979, 1182.2834567231462, 1189.2608075161033, 1209.0753267738528, 1194.3267948919204, 1224.2298239353179, 1225.2209822003483, 1235.3540714545595, 1252.71352225962, 1253.361246834512, 1265.0176462821537, 1243.2113175029185, 1248.2215246596584, 1249.7005110617513, 1276.4615596211111, 1266.0366251903229, 1266.2120330118046]
# [1153.5887045853133, 1140.801145966072, 1133.9353471978823, 1238.3429342883721, 1269.9547727375916, 1290.1659151347117, 1292.9807936664092, 1283.4866701365399, 1287.0241230663335, 1291.4881666256997, 1286.5530800350175, 1288.5062180500572, 1274.9169303624453, 1273.9877314628147, 1281.0373827444917, 1275.4453314787038, 1280.8460863609325, 1280.1815347382012, 1291.4621762740778, 1289.4312386410077, 1291.2511657687442]
# [1151.8295676923944, 1147.1455520233922, 1148.0721686013658, 1172.18750367597, 1312.9125459356646, 1349.8339528623785, 1367.8442272394939, 1365.9608227150252, 1362.3221321965952, 1379.8204538392752, 1368.5648946124984, 1364.6494082588131, 1372.846396879339, 1357.1140915178971, 1375.0590959098711, 1371.8990391209122, 1376.3828269840019, 1375.967674970108, 1367.2747026661179, 1378.7843646527003, 1377.5554089328548]

# c = 30, [0. - 3]
# [951.20234034579084, 950.53065136449823, 960.97338169433715, 958.27076374935098, 959.77345829998501, 946.20900370181175, 958.23677675665294, 964.51594372882812, 949.65600040282004, 946.91806813992355, 943.61087955089329, 950.02145968468199, 959.85597350822047, 956.83051548203605, 954.43568755880096, 971.90347693882234, 944.58466697517611, 957.89697252746885, 959.45668881588767, 954.11450584765714, 957.94613582398347]
# [1151.4846320008826, 1150.4004230148007, 1142.2647993857813, 1324.3030361390433, 1263.7443487891946, 1185.5254846653345, 1167.2386834955671, 1162.5256770526444, 1147.6603811104928, 1157.8767793696043, 1162.4181075431438, 1159.3831870309402, 1152.7106144481018, 1165.3613642869925, 1157.5029188860349, 1152.4947089217819, 1149.5149802455578, 1148.0856424988901, 1156.6566880991281, 1151.2616799614132, 1155.9625760533088]
# [1146.089628910094, 1140.4702934416782, 1145.2147088556223, 1139.96193789983, 1140.1323769921689, 1159.9875870863339, 1162.9858959098256, 1182.3821228262561, 1196.1767603373521, 1228.8914432591987, 1221.8721664639875, 1218.1814477831954, 1221.0163845207553, 1238.4097234022906, 1259.9445187822221, 1261.5404369119251, 1256.1925236744489, 1249.450139821429, 1265.8677808300424, 1281.492886424601, 1271.9611798730618]
# [1148.3312558220255, 1144.2290217382547, 1150.5516314716197, 1240.8912373396893, 1274.3895487199911, 1290.7026681967423, 1278.3618604081312, 1276.5614429665943, 1283.6440980728962, 1280.6930152173468, 1283.6681923716033, 1270.4874688990408, 1286.0768891835928, 1286.9770814906051, 1272.6571920257823, 1295.7061909040392, 1285.5450713688072, 1277.5505629216227, 1267.4831899653921, 1286.3756675537552, 1292.9524880118042]
# [1157.5654765662107, 1147.771711904531, 1145.3374226869389, 1171.1711039894915, 1317.906559186275, 1329.7909875480848, 1346.8829997105954, 1345.7663024646306, 1348.3904899408049, 1347.714029060455, 1331.1782698481832, 1352.6369580160176, 1350.9013455163608, 1338.0603461136882, 1356.3141086800745, 1358.3531127353483, 1363.5311335888564, 1351.1607591944639, 1353.313913946535, 1365.3581510044683, 1338.19182932739]

# c = 40, [0. - 4]
# [909.25086335084563, 892.992561980358, 896.16308478536007, 898.13607084856062, 909.53101000070126, 897.96770808716951, 882.02165660843457, 904.00730738265861, 901.57724811068488, 897.43958269611994, 904.07121478650845, 915.13378427529767, 910.0652398362829, 899.09215557961181, 890.28708232839961, 899.02396507111075, 929.16020803410925, 907.1820897816151, 892.72980565204011, 926.05814839800348, 886.69274916952895]
# [1135.6985278919001, 1146.0079014960163, 1144.5707412505285, 1295.1596367944167, 1194.2038643486733, 1063.5406379428118, 1063.1129798017994, 1057.9165149337382, 1042.6343242448652, 1062.4534296884326, 1050.641737936819, 1066.0178202736606, 1059.9121661030129, 1043.6859555499691, 1064.3156397347102, 1061.7466910404714, 1054.9033937346262, 1051.8845705452056, 1064.7659080705423, 1046.0454954828663, 1045.0720281105528]
# [1149.073879781175, 1142.2895079417078, 1143.5709756495528, 1145.7869087017948, 1154.2594600355646, 1152.5133609276011, 1179.5390221035373, 1166.6549123628797, 1193.071321934231, 1213.6167684699435, 1216.3402617258901, 1229.3166724164898, 1237.1233009117634, 1249.2249854383977, 1244.7593937581387, 1242.2968086711178, 1254.9792403470851, 1256.960886891319, 1255.1599418669498, 1258.5851947721658, 1243.416317396687]
# [1146.5182845966251, 1149.7243595717503, 1127.6145464802644, 1245.7112833384867, 1264.0412327916245, 1270.7442255334668, 1256.1779840950771, 1265.8648061577674, 1259.2477650113019, 1256.2360710106955, 1258.0912814339331, 1277.5405804416766, 1271.3409361948859, 1270.575359310252, 1264.5322243281514, 1281.8200769372372, 1276.8253350494811, 1276.4288202838316, 1277.5906698100048, 1285.9807916776524, 1270.4072757732888]
# [1149.0341352949758, 1141.0731979961213, 1136.9132018190151, 1187.6172380142934, 1292.3769212559394, 1330.2974989196798, 1329.9250348928408, 1314.7100225843224, 1330.3953530839985, 1315.1276266723521, 1327.5601541590445, 1327.9217806701031, 1330.8489755656569, 1317.1195786060064, 1339.5879010948995, 1329.2855875055416, 1317.2133105419332, 1303.3730831993694, 1320.0241066100248, 1326.6036503863668, 1333.6705401813647]

# c = 60, [0. - 6]
# [815.11309113890638, 791.11533384648465, 782.98216349260576, 812.20228725044399, 818.59836160958889, 814.72837861472294, 813.11254874559404, 803.82065468468954, 798.36040425603642, 815.10748486014597, 786.60139575665823, 789.28990873276712, 801.59885177871752, 801.61569831413442, 798.94362140637054, 805.85023184995191, 812.40219539615623, 803.00080758220338, 801.95015723043332, 799.91136866820443, 798.27914269795747]
# [1134.6961320914131, 1146.2654777363227, 1132.6714291544754, 1306.4164828132175, 1065.8155834794918, 890.7188427077557, 853.691134924994, 836.63658780175388, 845.89599330370788, 854.87715687979073, 857.62787651153633, 867.5432830278387, 859.8392600497325, 855.32787227867686, 854.38347280277287, 859.06433332921711, 850.86425882284095, 851.75028764687522, 863.55037899109027, 844.32989172728355, 869.43738404598093]
# [1146.8377018247775, 1146.4300943857177, 1133.3398398558468, 1137.6843030452899, 1156.3228242787766, 1170.5031487262816, 1175.1608457959903, 1165.5469191623811, 1209.0379054242667, 1217.8414556584453, 1233.7255884194687, 1234.3606589602041, 1217.818437515532, 1227.8182950894734, 1240.1487343110593, 1238.4901700572875, 1254.4475602507596, 1231.7745767033168, 1254.2299542510104, 1263.8385230668359, 1261.1681909081412]
# [1149.3743540950063, 1147.5806309684135, 1131.4484086592793, 1218.345923807962, 1257.9584092427344, 1254.0541212909982, 1256.1279756663218, 1258.3558923073622, 1263.9240190544037, 1261.8721153576141, 1258.8739301537651, 1276.071235413367, 1251.9245837854446, 1265.6884386083577, 1256.5636056025792, 1261.5066292417164, 1273.6628927392176, 1262.8858097272569, 1252.5010522515099, 1255.0637906446277, 1252.0142972331773]
# [1148.873760640957, 1152.0477949553278, 1133.8360951662592, 1181.8171165204581, 1268.2199560383426, 1288.6213103394102, 1277.6359670476759, 1283.4442783139709, 1281.8171064180337, 1279.9259518714118, 1295.3026978780631, 1291.988648430902, 1276.4322694535292, 1286.252982974785, 1285.3502134108498, 1257.6728085651434, 1273.024089564623, 1288.7778107775282, 1291.9281700094325, 1281.8381564431736, 1277.4776988532344]


# c = 80, [0. - 8]
# [705.68398877153015, 704.4385226184603, 711.19566038600078, 711.56849763840103, 688.31907485615284, 713.00910775564648, 686.17032633760039, 716.93893887860747, 704.23174781570015, 703.17454550529499, 704.85882723994473, 688.07730733519929, 703.87644299779606, 710.43341282088841, 702.80741544552404, 690.53920890253698, 702.66952711637543, 685.01534630029437, 697.77629114576007, 702.65992084629374, 681.03065214209221]
# [1137.2280103798116, 1145.306933837003, 1137.9840311737, 1278.0802272272745, 954.04774715547137, 698.87960513574751, 647.23987574294188, 665.23208085784779, 660.2800976776947, 639.97692312497202, 657.41336170044747, 665.67757122028536, 644.39497977974429, 651.44842386208916, 661.28636465137515, 657.20281131377783, 654.71016532555177, 650.81408993744117, 665.79359656167208, 640.33386199414667, 661.70289083554667]
# [1127.975455845055, 1139.6905390914083, 1149.2466915807956, 1141.1848169766631, 1162.846331938792, 1167.6096576113594, 1173.1955087933384, 1181.5711587302656, 1209.8302574072964, 1200.8126280849815, 1208.544499583242, 1215.8719406780031, 1237.9728517995386, 1224.7912709164946, 1257.5376480648845, 1236.0215922520429, 1237.3409587854289, 1226.819818650926, 1243.8414149143487, 1258.7008645986803, 1238.9825605596507]
# [1142.9214479791535, 1134.7423573930032, 1145.9369059981661, 1226.9143413062034, 1258.98329550997, 1243.9320518474985, 1257.0437399550715, 1229.7542439783379, 1257.8362408758392, 1246.476296057989, 1250.6506767149435, 1255.6797447971946, 1249.8775684474701, 1250.1257874561747, 1255.475021697574, 1257.1771870732077, 1232.0281316439607, 1251.0187552058405, 1241.9397678149717, 1237.1977621550491, 1255.2978314666482]
# [1158.4629863309019, 1145.9805684793805, 1152.5684531880506, 1185.5911700947756, 1216.9435469225205, 1229.5753175679724, 1235.8562728209831, 1224.553301092448, 1225.4806600454817, 1225.1863017693697, 1213.0823557131112, 1232.003942005065, 1220.4323094047568, 1249.3321120948344, 1236.7406807717048, 1243.3119722915758, 1224.6384092085066, 1231.0401411766932, 1225.1978692301786, 1240.466846748333, 1230.955630178215]

# c = 30, [0. - 3] more points

# c = 40, [0. - 4]